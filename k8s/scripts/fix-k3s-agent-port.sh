#!/bin/bash

# k3s-agent í¬íŠ¸ ì¶©ëŒ í•´ê²° ìŠ¤í¬ë¦½íŠ¸

echo "ğŸ”§ k3s-agent í¬íŠ¸ ì¶©ëŒ í•´ê²°"
echo "================================"
echo ""

echo "âš ï¸  ì›Œì»¤ ë…¸ë“œì—ì„œ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤"
echo ""
echo "ë¬¸ì œ: listen tcp 127.0.0.1:6444: bind: address already in use"
echo "ì›ì¸: í¬íŠ¸ 6444ê°€ ì´ë¯¸ ì‚¬ìš© ì¤‘ì´ê±°ë‚˜ ì´ì „ k3s í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ ì¤‘"
echo ""
echo "í•´ê²° ë°©ë²•:"
echo "================================"
echo ""
echo "1. ì‹¤í–‰ ì¤‘ì¸ k3s í”„ë¡œì„¸ìŠ¤ í™•ì¸:"
echo "   ps aux | grep k3s | grep -v grep"
echo ""
echo "2. k3s í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ:"
echo "   sudo /usr/local/bin/k3s-killall.sh"
echo ""
echo "3. í¬íŠ¸ 6444ë¥¼ ì‚¬ìš©í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ í™•ì¸:"
echo "   sudo lsof -i :6444"
echo "   # ë˜ëŠ”"
echo "   sudo netstat -tlnp | grep 6444"
echo ""
echo "4. í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ (í•„ìš”í•œ ê²½ìš°):"
echo "   sudo kill -9 <PID>"
echo ""
echo "5. k3s-agent ì¬ì‹œì‘:"
echo "   sudo systemctl restart k3s-agent"
echo ""
echo "6. ìƒíƒœ í™•ì¸:"
echo "   sudo systemctl status k3s-agent"
echo ""
echo "================================"
echo "ë˜ëŠ” ì™„ì „ ì¬ì‹œì‘:"
echo "================================"
echo ""
echo "1. k3s-agent ì™„ì „ ì¢…ë£Œ:"
echo "   sudo systemctl stop k3s-agent"
echo "   sudo /usr/local/bin/k3s-killall.sh"
echo ""
echo "2. ì ì‹œ ëŒ€ê¸°:"
echo "   sleep 5"
echo ""
echo "3. k3s-agent ì¬ì‹œì‘:"
echo "   sudo systemctl start k3s-agent"
echo ""
echo "4. ë¡œê·¸ í™•ì¸:"
echo "   sudo journalctl -u k3s-agent -f"
echo ""

